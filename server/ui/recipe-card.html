<!doctype html>
<html>
  <head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"></head>
  <body style="font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin:16px; max-width:780px;">
    <div id="root"></div>
    <script>
      // Read props from either source
      const r = (window.openai && window.openai.structuredContent) || window.globalProps || {};
      const root = document.getElementById('root');

      function list(items, ordered){
        const tag = ordered ? 'ol' : 'ul';
        return `<${tag} style="margin:6px 0 0 18px;">${
          (items||[]).map(x => `<li>${x.name ? `${x.qty} ${x.name}` : x}</li>`).join('')
        }</${tag}>`;
      }

      root.innerHTML = `
        <h2 style="margin:0 0 8px 0;">${r.title || 'My personal 123 Recipe'}</h2>
        ${r.imageUrl ? `<img src="${r.imageUrl}" alt="${r.title||''}" style="width:100%; max-height:340px; object-fit:cover; border-radius:12px;"/>` : ''}
        <div style="margin-top:10px; font-size:14px; opacity:0.9;">
          ${r.nutrition && r.nutrition.kcal != null ? `${r.nutrition.kcal} kcal • ${r.nutrition.protein_g}g P • ${r.nutrition.carb_g}g C • ${r.nutrition.fat_g}g F` : ''}
        </div>
        ${Array.isArray(r.ingredients) ? `<h3 style="margin:14px 0 6px 0;">Ingredients</h3>${list(r.ingredients,false)}` : ''}
        ${Array.isArray(r.steps) ? `<h3 style="margin:14px 0 6px 0;">Steps</h3>${list(r.steps,true)}` : ''}
        ${Array.isArray(r.benefits) ? `<h3 style="margin:14px 0 6px 0;">Benefits</h3>${list(r.benefits,false)}` : ''}
        ${Array.isArray(r.tags) ? `<div style="margin-top:10px;">${r.tags.map(t=>`<span style="font-size:12px; padding:4px 8px; border:1px solid #e5e7eb; border-radius:999px; margin-right:6px;">${t}</span>`).join('')}</div>` : ''}
      `;
    </script>
  </body>
</html>
